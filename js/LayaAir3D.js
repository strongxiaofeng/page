var LayaAir3D=function(){function a(){var a=this;this.speed=0,this.floors=[],Laya.MiniAdpter.init(),Laya3D.init(0,0,!0),Laya.stage.scaleMode=Laya.Stage.SCALE_FULL,Laya.stage.screenMode=Laya.Stage.SCREEN_NONE,Laya.Stat.show();var e=Laya.stage.addChild(new Laya.Scene);this.scene=e,this.gameContainer=new Laya.Sprite3D,this.gameContainer.transform.translate(new Laya.Vector3(0,0,0)),this.scene.addChild(this.gameContainer);var t=e.addChild(new Laya.Camera(0,1,100));t.transform.translate(new Laya.Vector3(0,5,20)),t.transform.rotate(new Laya.Vector3(-20,0,0),!0,!1),t.clearColor=null,t.addComponent(CameraScript);var o=e.addChild(new Laya.DirectionLight);o.color=new Laya.Vector3(.6,.6,.6),o.direction=new Laya.Vector3(1,-1,0);var r=e.addChild(new Laya.MeshSprite3D(new Laya.CylinderMesh(2,100)));r.transform.rotate(new Laya.Vector3(0,-50,0),!1,!1);s=new Laya.StandardMaterial;s.diffuseTexture=Laya.Texture2D.load("res/layabox.png"),r.meshRender.material=s,this.root=r;var s,n=e.addChild(new Laya.MeshSprite3D(new Laya.SphereMesh(.5)));(s=new Laya.StandardMaterial).diffuseTexture=Laya.Texture2D.load("res/layabox.png"),n.meshRender.material=s,n.transform.translate(new Laya.Vector3(0,3,3)),this.ball=n,n.addComponent(BallScript),n.addComponent(Laya.Rigidbody),n.addComponent(Laya.SphereCollider),t._scripts[0].ball=n,t._scripts[0].root=r,[1,0,-1,-2,-3,-4,-5].map(function(e){a.createFloor(e)}),Laya.stage.on("mousedown",this,this.onMouseDown),Laya.stage.on("mousemove",this,this.mousemove),Laya.stage.on("mouseout",this,this.mouseout),Laya.stage.on("mouseup",this,this.mouseup),setInterval(this.onInterval.bind(this),100)}return a.prototype.onMouseDown=function(){this.isMouseDown=!0},a.prototype.mousemove=function(a){this.isMouseDown&&(this.lastX&&this.gameContainer.transform.rotate(new Laya.Vector3(0,Laya.stage.mouseX-this.lastX,0),!1,!1),this.lastX=Laya.stage.mouseX)},a.prototype.mouseout=function(){this.isMouseDown=!1,this.lastX=0},a.prototype.mouseup=function(){this.isMouseDown=!1,this.lastX=0},a.prototype.createFloor=function(a){console.log("createFloor "+a);var e=new Laya.Sprite3D;e.transform.translate(new Laya.Vector3(0,10*a,0)),this.gameContainer.addChild(e),this.curFloorIndex=a;for(var t=Math.floor(4*Math.random()),o=0;o<4;o++)if(o!=t){var r=new Laya.MeshSprite3D(new Laya.BoxMesh(4,4,1));e.addChild(r),this.floors.push(r),r.transform.translate(new Laya.Vector3(o%2==1?2:-2,0,o<2?2:-2)),r.addComponent(FloorScript),r.addComponent(Laya.BoxCollider),r._colliders[0].size=new Laya.Vector3(4,1,4);var s=new Laya.StandardMaterial;s.diffuseTexture=Laya.Texture2D.load("res/layabox.png"),r.meshRender.material=s}},a.prototype.onInterval=function(){for(var a=this.floors.length-1;a>=0;a--)this.floors[a].transform&&this.floors[a].transform.position.y-this.ball.transform.position.y>2&&(this.floors[a].destroy(),this.floors.splice(a,1));this.checkFloorCreate(),this.root.transform.position.y=this.floors[0].transform.position.y},a.prototype.checkFloorCreate=function(){for(;this.floors.length<15;)this.createFloor(this.curFloorIndex-1)},a}();new LayaAir3D;